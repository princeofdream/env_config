From b06f0f3fd0a346ff70f05effd8923fc354b264ee Mon Sep 17 00:00:00 2001
From: "jin.li" <jin.li@nufront.com>
Date: Sun, 21 Aug 2016 21:28:03 +0800
Subject: [PATCH] powerline-shell Add segment git_branch

---
 config.py.dist             |  1 +
 segments/get_git_branch.sh |  9 +++++++++
 segments/git_branch.py     | 23 +++++++++++++++++++++++
 3 files changed, 33 insertions(+)
 create mode 100644 segments/get_git_branch.sh
 create mode 100644 segments/git_branch.py

diff --git a/config.py.dist b/config.py.dist
index e84ff95..4df1def 100644
--- a/config.py.dist
+++ b/config.py.dist
@@ -38,6 +38,7 @@ SEGMENTS = [
 	# 'git',
 	# 'git_ext',
 	'android_prj',
+	'git_branch',
 
 # Show the current mercurial branch and status
     'hg',
diff --git a/segments/get_git_branch.sh b/segments/get_git_branch.sh
new file mode 100644
index 0000000..e69ae9a
--- /dev/null
+++ b/segments/get_git_branch.sh
@@ -0,0 +1,9 @@
+#!/usr/bin/env bash
+
+# get_branch=`git branch 2>/dev/null`
+get_branch=`git branch 2>/dev/null |grep '\*'`
+
+branch=${get_branch:2}
+echo -n "($branch)"
+
+
diff --git a/segments/git_branch.py b/segments/git_branch.py
new file mode 100644
index 0000000..ee22c6a
--- /dev/null
+++ b/segments/git_branch.py
@@ -0,0 +1,23 @@
+
+import os
+import subprocess
+import string
+import sys
+
+def add_git_branch_segment(powerline):
+	get_info = subprocess.Popen(["/home/$WHOAMI/.vim/bundle/powerline-shell/segments/get_git_branch.sh",""], stdout=subprocess.PIPE)
+	branch = get_info.stdout.read()
+	#  branch = ""
+	#  g_st = string.find(branch,"*")
+	#  fg = Color.REPO_CLEAN_FG
+	#  bg = Color.REPO_CLEAN_BG
+	#  if g_st >= 0:
+	#      ## can not find * in branch
+	#      fg = Color.REPO_DIRTY_FG
+	#      bg = Color.REPO_DIRTY_BG
+	fg = Color.REPO_DIRTY_FG
+	bg = Color.REPO_DIRTY_BG
+	s_len = len(branch)
+	if s_len > 0:
+		powerline.append(' %s ' % branch, fg, bg)
+
-- 
1.8.3.1

